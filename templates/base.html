{% load staticfiles %}
{% load compress %}
{% load debate_tags %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block page-title %}{% endblock %}</title>
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUwOEU5NDc5RDJDMTExRTRCRjQ2OUZDNTgxMzU0NEMzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUwOEU5NDdBRDJDMTExRTRCRjQ2OUZDNTgxMzU0NEMzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTA4RTk0NzdEMkMxMTFFNEJGNDY5RkM1ODEzNTQ0QzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTA4RTk0NzhEMkMxMTFFNEJGNDY5RkM1ODEzNTQ0QzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5Pg6RUAAAAnklEQVR42mL8//8/Ay0BI50s6OzspLrR5eXlQJKJgcaABdNOygFyeNDcB0PfAhZcEvv371+zZg0xRujp6aWnp4/AIDIyMlJSUoJznz17tmTJEgjb0dHR1NQULsXBwUGOBfxggFVKWFhYXl5+xCTTUQtGLRi1YFiXpmhAXFy8rKwMwhYQEKC+BcAymfgSdOCCiBbtO5r7gHHIt64BAgwAx6wnJnaZud8AAAAASUVORK5CYII=" />
  {% compress css %}
  <link rel="stylesheet" type="text/x-scss" charset="utf-8" href="{% static 'css/style.scss' %}" />
  {% endcompress %}
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

<body id="{% block body-id %}{% endblock %}" class="{% block body-class %}{% endblock %}">

  <div id="wrap">

    {% block body %}

    {% block nav %}{% include "nav/nav.html" %}{% endblock nav %}

    <div id="container" class="container-fluid">

      <div class="row page-header">
        <div class="col-md-12">
          <h1 class="h2 pull-left">{% block head-title %}{% endblock %}</h1>
          {% block page-header %}{% endblock %}
        </div>
       </div>

      {% if messages %}
        <div class="row">
          <div class="col-md-12 form-inline hidden-print" id="messages">
            {% for message in messages %}
              <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %} updated alert-dismissable">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                {{ message }}
              </div>
            {% endfor %}
            </div>
        </div>
      {% endif %}

      <div class="row">
        <div class="col-md-12 form-inline hidden-print" id="header-options">
        {% block header %}{% endblock %}
        </div>
      </div>

      {% block content %}{% endblock content %}

    </div>

    {% endblock body %}

  </div>

  {% block footer %}{% include "footer.html" %}{% endblock footer %}

  {% compress js %}
  <script type="text/javascript" language="javascript" charset="utf-8" src="{% static 'vendors/modernizr/modernizr.js' %}"></script>
  <script type="text/javascript" language="javascript" charset="utf-8" src="{% static 'vendors/jquery/jquery-2.1.0.min.js' %}"></script>
  <script type="text/javascript" language="javascript" charset="utf-8" src="{% static 'vendors/bootstrap/javascripts/bootstrap.min.js' %}"></script>
  <script type="text/javascript" language="javascript" charset="utf-8" src="{% static 'vendors/datatables/jquery.dataTables.min.js' %}"></script>
  <script type="text/javascript" language="javascript" charset="utf-8" src="{% static 'vendors/datatables/dataTables.bootstrap.js' %}"></script>
  <script type="text/javascript" language="javascript" charset="utf-8" src="{% static 'vendors/datatables/dataTables.fixedHeader.min.js' %}"></script>
  {% endcompress %}
  <script type="text/javascript">
    $.extend( true, $.fn.dataTable.defaults, {
      // Default Data Table options
      "sDom":
        "<'row'<'col-md-12 table-container'lr"+ // f = the filter
        "t"+
        "f<p>",
      "bPaginate": false,
      "oLanguage": {
        "sSearch": "Search: "
      }
    });

    $(document).ready(function(){

      // Enable hover tooltips for all elements
      $('[data-toggle=tooltip]').tooltip({
        'html': true,
        'placement': 'bottom'
      });

      // Enable AJAX-based hover tooltips to lookup speaker names
      $('.team-speakers-hover').tooltip({
        title: getTeamSpeakers,
        'html': true,
        'placement': 'bottom'
      });

      // Disable buttons post submission
      $('.submit-disable').on('click', function () {
        var $btn = $(this).button('loading');
      });

      var cachedData = Array();

      function getTeamSpeakers(){
          var element = $(this);
          var id = element.attr('id').replace("team_speakers_", "");
          if(id in cachedData){
              return cachedData[id];
          }
          var localData = "error";
          $.ajax('{{ tournament.get_public_url  }}participants/team_list/' + id + '/', {
              async: false,
              success: function(data){
                  localData = data[0] + ", " + data[1] + ", " + data[2];
              }
          });
          cachedData[id] = localData;
          return localData;
      }

    });

    // Test for emoji support, if not present then load and execute a polyfill
    Modernizr.load({
      test: Modernizr.emoji,
      nope: '{% static '//twemoji.maxcdn.com/twemoji.min.js' %}',
      complete : function () {
        if (!Modernizr.emoji) {
          twemoji.parse(document.body);
        }
      }
    });

  </script>
  {% block extra-js %}{% endblock extra-js %}

  {% if debug %}
    <!-- No Analytics -->
  {% else %}
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-314178-25', 'auto');
      ga('send', 'pageview');
    </script>
  {% endif %}

</body>
</html>
